<html>
    <head>
        <meta charset="ISO-8859-1">
        <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
            function getUrlVars(){
                var contentx = unescape(window.location.href);
                contentx = contentx.split("#0").join("ä");
                contentx = contentx.split("#1").join("ö");
                contentx = contentx.split("#2").join("ü");
                contentx = contentx.split("#3").join("Ä");
                contentx = contentx.split("#4").join("Ö");
                contentx = contentx.split("#5").join("Ü");
                contentx = contentx.split("#6").join("ß");
                
                return contentx.slice(contentx.indexOf('?') + 1).split('&');  
            }

            function getMiddleColor(){  
                var middle;
                var urlVars = getUrlVars();
                middle = urlVars[0].charAt(0)-'0';   
                for(var i = 1; i < urlVars.length; i++)
                {    
    
                    if(middle!=(urlVars[i].charAt(0)-'0')){
                        return "#FFFF99";
                    }
                }
                switch(middle){
                    case 0: return "#F28080"; //excluded
                    case 1: return "#DDE8A0"; //suggested
                    case 2: return "#6BF26D"; //established
                    case 3: return "#DDE8A0"; //unclear      
                }
            }

            function getColor(colorInteger){  
                switch(colorInteger){
                    case '0': return -150;
                    case '1': return 0;
                    case '2': return 25;
                    case '3': return 10;
                }
            }

            function getHeaderColor(){
                var urlVars = getUrlVars();
                var first = urlVars[0].charAt(0);
                switch(first){
                    case '0': return "#EB4242"; //excluded
                    case '1': return "#EBF707"; //suggested
                    case '2': return "#7CF56E"; //established
                    case '3': return "#B7BAB6"; //unclear   
                }
        
    
            }
            function getTable(){
	
                var urlVars = getUrlVars();
                var parent = urlVars[0].substring(1, urlVars[0].length-1);
                var table = new Array();
                table[0] = new Array();
                table[0][0] = "Diagnostic";
                table[0][1] = "Parent";
                table[0][2] = "Impact";
                table[0][3] = "Relevance";
                table[1] = new Array();
                table[1][0] = parent;
                table[1][1] =  null;
                table[1][2] = 0;
                table[1][3] = 0;

                for(var i = 1; i < urlVars.length; i++){
                    elem = urlVars[i].split("@");
                    color = getColor(elem[0].charAt(0));
    
                    table[i+1] = new Array();
                    table[i+1][0] = elem[0].substr(1, elem[0].length);
                    table[i+1][1] = elem[1];
                    table[i+1][2] = 1;
                    table[i+1][3] = color;   
                }	  

                return table;
            }
 	 
            google.load("visualization", "1", {packages:["treemap"]});
            google.setOnLoadCallback(drawChart);
            function drawChart() {
                // Create and populate the data table.
                var data = google.visualization.arrayToDataTable(getTable());

                // Create and draw the visualization.
                var tree = new google.visualization.TreeMap(document.getElementById('chart_div'));
        
                tree.draw(data, {
                    minColor: '#F28080',
                    midColor: getMiddleColor(),
                    maxColor: '#6BF26D',
                    headerHeight: 25,
                    fontSize: 13,
                    headerColor: getHeaderColor(),
                    fontColor: 'black',
                    maxColorValue: 125,
                    minColorValue: -200
                });
            }
        </script>
    </head>

    <body>
        <div id="chart_div" style="width: 900px; height: 500px;"></div>
    </body>
</html>